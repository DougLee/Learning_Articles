1. 架构的发展过程
2. 什么是zookeeper
3. zookeeper安装部署
4. zoo.cfg配置文件解析




单一节点 -> 水平伸缩






##  分布式环境特点



## 分布式环境下面临的问题

* 网络通信 网络本身不可靠, 因此会涉及到一些网络通信问题.
* 网络分区(脑裂): 当网络发生异常导致分布式系统中部分节点之间的网络延时不断增大，最终导致组成分布式架构的所有节点，只有部分节点能够正常通信.
* 三态: 分布式架构中除了成功和失败两种状态还有超时的状态.
* 分布式事务:ACID

##CAP/BASE理论

### CAP 

C 一致性(Consistency): 所有节点上的数据时刻保持一致

A 可用性(Availability): 每个请求都能够收到一个相应, 无论相应成功或者失败

P 分区容错(Partition-tolerance): 系统出现脑裂以后, 可能导致某些server与集群汇总的其他机器失去联系.

CAP理论仅适用于原子读写的NoSQL场景, 不适用于数据库系统.

### BASE

基于CAP理论，CAP理论并不适用于数据库事务（因为更新一些错误的数据而导致数据出现紊乱，无论什么样的数据库高可用方案都是徒劳），虽然XA事务可以保证数据库在分布式系统下的ACID特性，但是会带来性能方面的影响

eBay尝试了一种完全不同的方法, 放宽了对事务ACID的要求, 提出了BASE理论.

BA (Basically available): 数据库采用分片模式， 把100W的用户数据分布在5个实例上。如果破坏了其中一个实例，仍然可以保证80%的用户可用

S (soft-state): 在C/S模式系统中, server端是否有状态, 决定了系统是否具备良好的水平扩展, 负载均衡, 故障恢复等特性. server端承诺会维护client的状态数据, 这个状态仅仅维持一小段时间, 这段时间以后, server端就会丢弃这个状态, 恢复正常.

E (Eventually consistent): 数据的最终一致性.

## 初步认识Zookeeper

zookeeper是一个开源的分布式协调服务, 是由雅虎基于google chubby创建的.

### zookeeper是什么

分布式数据一致性的解决方案

### zookeeper能做什么

* 数据的发布/订阅(配置中心: disconf)
* 负载均衡(dubbo + zookeeper)
* 命名服务
* master选举(kafka, hadoop, hbase)
* 分布式队列
* 分布式锁

### zookeeper的特性

* 顺序一致性: 从同一个客户端发起的事务请求, 最终会严格按照顺序被应用到zookeeper中
* 原子性: 所有的事务请求的处理结果在整个集群中的所有机器上的应用情况是一致的. 就是说要么整个集群中的所有机器都成功应用了某一事务, 要么全都不应用
* 可靠性: 一旦服务器成功应用了某一个事务数据, 并且对客户端做了响应, 那么这个暑假在整个集群汇总一定是同步并且保留下来的.
* 实时性: 一旦一个事务被成功应用, 客户端就能够立即从服务端读取到事务变更后的最新暑假状态. (zookeeper仅保证在一定时间内, 解决实时)





















